<!DOCTYPE html>
<html>
  <head>
    <!-- <meta charset="utf-8"> -->
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>Trip Info</title>
    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link href='https://fonts.googleapis.com/css?family=Comfortaa' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Bungee+Hairline' rel='stylesheet' type='text/css'>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB0VhvAXQGPpZ7i8XOc0CznTZoFGOmIHvg">
    </script>
  </head>

  <body>
    <header>
      <div class="appname">
        <strong><h1>Pear</h1></strong>
      </div>

      <!-- Navigation Bar -->
      <div class="nav">
        <ul>
          <li><a href="/mainpage">Home</a></li>
          <li><a href="/newtrip">Create</a></li>
          <li><a href="/jointrip">Join</a></li>
          <li><a href="/userinfo">User</a></li>
        </ul>
      </div>
    </header>

    <!-- Content -->
    <section class="content">
      <h2 class="tripinfo">{{ trip.tripname }}</h2>
      {% for car in cars %}
        <div class="car">
          <!-- Display the driver name -->
          <div class="names">
            <h3 id="drivername">{{ car.driver_key.get().name }}</h3>
          </div>
          <!-- div for the background car image -->
          <div class="container">
            <!-- Display the list of passenger names -->
            <div class="names">
              <ul>
                {% for passenger in car.passengers_key %}
                  <li>{{passenger.get().name}}</li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
      {% endfor %}

      <div id="edittrip">
        <button><a href="/edittrip?key={{trip.key.urlsafe()}}">Edit Trip</a></button>
      </div>
    </section>

    <!-- MAP ONLY
    <div id="map" style="width: 400px; height: 300px;"></div>

    <script type="text/javascript">

    var address = 'London, UK';

    var map = new google.maps.Map(document.getElementById('map'), {
        mapTypeId: google.maps.MapTypeId.TERRAIN,
        zoom: 6
    });

    var geocoder = new google.maps.Geocoder();

    geocoder.geocode({
       'address': address
    },
    function(results, status) {
       if(status == google.maps.GeocoderStatus.OK) {
          new google.maps.Marker({
             position: results[0].geometry.location,
             map: map
          });
          map.setCenter(results[0].geometry.location);
       }
    });

    </script> -->
    <!-- MAP WITH ROUTE-->
    <div id="map" style="width: 400px; height: 300px;"></div>
    <div id="duration">Duration: </div>
    <div id="distance">Distance: </div>
    <script type="text/javascript">

      var directionsService = new google.maps.DirectionsService();
      var directionsDisplay = new google.maps.DirectionsRenderer();

      var myOptions = {
        zoom:7,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      }

      var map = new google.maps.Map(document.getElementById("map"), myOptions);
      directionsDisplay.setMap(map);

      var request = {
          origin: 'Chicago',
          destination: 'New York',
          travelMode: google.maps.DirectionsTravelMode.DRIVING
      };

      directionsService.route(request, function(response, status) {
         if (status == google.maps.DirectionsStatus.OK) {

            // Display the distance:
            document.getElementById('distance').innerHTML +=
               response.routes[0].legs[0].distance.value + " meters";

            // Display the duration:
            document.getElementById('duration').innerHTML +=
               response.routes[0].legs[0].duration.value + " seconds";

            directionsDisplay.setDirections(response);
         }
      });
    </script>
    <form method="post" action="{{ trip.url() }}">
      Enter a comment: <textarea name="text" placeholder="Comment goes here"></textarea>
      <br>
      <input type="hidden" name="action" value="comment">
      <p><input type="submit" value="Submit"></p>
    </form>
    {% for comment in comments %}
      <article>
        <h3>
          {{comment.user_key.get().name}}
        </h3>
        {{comment.text}}
        <div class="date">{{ comment.date }}</div>
      </article>
    {% endfor %}
  </body>
</html>
